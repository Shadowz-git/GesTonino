import{a as oe}from"./chunk-JCLZTICA.js";import{b as x,d as w,e as T,g as X,i as O,j as D,k as N,m as Y,n as Z,o as $,p as ee,q as te,r as ne,s as C,t as ie}from"./chunk-YOZF4BM5.js";import{b as K}from"./chunk-U455DCWQ.js";import{i as A,j as F,k as J}from"./chunk-CVV52KBV.js";import{Db as R,Fb as U,Ja as s,Ka as I,Ua as f,Y as L,_a as S,a as q,eb as m,fb as B,gb as o,hb as i,ia as g,ib as M,ja as _,jb as P,nb as c,ob as u,ra as p,tb as d,ub as h,vb as k,wb as G,xb as y,yb as v,zb as b}from"./chunk-VETP3HG3.js";function de(l,n){if(l&1&&(o(0,"option",11),d(1),i()),l&2){let t=n.$implicit;m("value",t),s(),h(t)}}function le(l,n){if(l&1){let t=P();o(0,"button",12),c("click",function(){g(t);let r=u();return _(r.deleteSelected.emit())}),d(1," Elimina Selezionati "),i()}}function se(l,n){if(l&1){let t=P();o(0,"button",13),c("click",function(){g(t);let r=u();return _(r.toggleSelectAll())}),d(1),i()}if(l&2){let t=u();s(),k(" ",t.isAllSelected?"Deseleziona Tutti":"Seleziona Tutti"," ")}}var V=class l{searchQuery="";selectedCount=0;isAllSelected=!1;itemsPerPage=10;itemsPerPageOptions=[5,10,20,50];search=new p;selectAll=new p;deleteSelected=new p;itemsPerPageChange=new p;addProduct=new p;constructor(){}onSearch(n){this.search.emit(this.searchQuery)}toggleSelectAll(){this.selectAll.emit()}onDeleteSelected(){this.deleteSelected.emit()}onItemsPerPageChange(n){this.itemsPerPageChange.emit(this.itemsPerPage)}onAddProduct(){this.addProduct.emit()}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=f({type:l,selectors:[["app-header-inventory"]],inputs:{searchQuery:"searchQuery",selectedCount:"selectedCount",isAllSelected:"isAllSelected",itemsPerPage:"itemsPerPage",itemsPerPageOptions:"itemsPerPageOptions"},outputs:{search:"search",selectAll:"selectAll",deleteSelected:"deleteSelected",itemsPerPageChange:"itemsPerPageChange",addProduct:"addProduct"},decls:13,vars:5,consts:[[1,"flex","flex-wrap","items-center","justify-between","bg-white","p-4","shadow-md","rounded"],[1,"flex","items-center","space-x-2","w-full","md:w-1/3"],["type","text","placeholder","Cerca per nome o codice...",1,"w-full","border","border-gray-300","rounded-md","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","space-x-2","w-full","md:w-1/3","justify-center","mt-2","md:mt-0"],["for","itemsPerPageSelect",1,"text-sm","font-medium"],["id","itemsPerPageSelect",1,"border","border-gray-300","rounded-md","px-2","py-1","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-4","w-full","md:w-1/3","justify-end","mt-2","md:mt-0"],["class","bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md",3,"click",4,"ngIf"],["class","bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md",3,"click",4,"ngIf"],[1,"bg-green-500","hover:bg-green-600","text-white","px-4","py-2","rounded-md",3,"click"],[3,"value"],[1,"bg-red-500","hover:bg-red-600","text-white","px-4","py-2","rounded-md",3,"click"],[1,"bg-gray-500","hover:bg-gray-600","text-white","px-4","py-2","rounded-md",3,"click"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"div",1)(2,"input",2),b("ngModelChange",function(a){return v(e.searchQuery,a)||(e.searchQuery=a),a}),c("ngModelChange",function(a){return e.onSearch(a)}),i()(),o(3,"div",3)(4,"label",4),d(5,"Elementi per pagina:"),i(),o(6,"select",5),b("ngModelChange",function(a){return v(e.itemsPerPage,a)||(e.itemsPerPage=a),a}),c("ngModelChange",function(a){return e.onItemsPerPageChange(a)}),S(7,de,2,2,"option",6),i()(),o(8,"div",7),S(9,le,2,0,"button",8)(10,se,2,1,"button",9),o(11,"button",10),c("click",function(){return e.onAddProduct()}),d(12," Aggiungi Prodotto "),i()()()),t&2&&(s(2),y("ngModel",e.searchQuery),s(4),y("ngModel",e.itemsPerPage),s(),m("ngForOf",e.itemsPerPageOptions),s(2),m("ngIf",e.selectedCount>0),s(),m("ngIf",e.selectedCount>0))},dependencies:[F,A,C,ee,te,x,$,w,O],encapsulation:2})};var Q=class l{product;cancel=new p;save=new p;updatedProduct;ngOnInit(){this.updatedProduct=q({},this.product)}onCancel(){this.cancel.emit()}onSave(){this.save.emit(this.updatedProduct)}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=f({type:l,selectors:[["app-edit-product-dialog"]],inputs:{product:"product"},outputs:{cancel:"cancel",save:"save"},decls:26,vars:4,consts:[[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","flex","justify-center","items-center","z-50"],[1,"bg-white","rounded-lg","shadow-lg","w-96","p-6"],[1,"text-xl","font-semibold","mb-4"],[1,"space-y-4"],["for","name",1,"block","text-sm","font-medium"],["id","name","name","name","type","text",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["for","quantity",1,"block","text-sm","font-medium"],["id","quantity","name","quantity","type","number",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["for","price",1,"block","text-sm","font-medium"],["id","price","name","price","type","number",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["for","code",1,"block","text-sm","font-medium"],["id","code","name","code","type","text","disabled","",1,"w-full","bg-gray-200","border","border-gray-300","rounded-md","p-2",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-4","mt-6"],[1,"px-4","py-2","bg-gray-200","hover:bg-gray-300","rounded-md",3,"click"],[1,"px-4","py-2","bg-blue-500","text-white","hover:bg-blue-600","rounded-md",3,"click"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"Modifica Prodotto"),i(),o(4,"form",3)(5,"div")(6,"label",4),d(7,"Nome:"),i(),o(8,"input",5),b("ngModelChange",function(a){return v(e.updatedProduct.name,a)||(e.updatedProduct.name=a),a}),i()(),o(9,"div")(10,"label",6),d(11,"Quantit\xE0:"),i(),o(12,"input",7),b("ngModelChange",function(a){return v(e.updatedProduct.quantity,a)||(e.updatedProduct.quantity=a),a}),i()(),o(13,"div")(14,"label",8),d(15,"Prezzo:"),i(),o(16,"input",9),b("ngModelChange",function(a){return v(e.updatedProduct.price,a)||(e.updatedProduct.price=a),a}),i()(),o(17,"div")(18,"label",10),d(19,"Codice:"),i(),o(20,"input",11),b("ngModelChange",function(a){return v(e.updatedProduct.code,a)||(e.updatedProduct.code=a),a}),i()()(),o(21,"div",12)(22,"button",13),c("click",function(){return e.onCancel()}),d(23,"Annulla"),i(),o(24,"button",14),c("click",function(){return e.onSave()}),d(25,"Salva"),i()()()()),t&2&&(s(8),y("ngModel",e.updatedProduct.name),s(4),y("ngModel",e.updatedProduct.quantity),s(4),y("ngModel",e.updatedProduct.price),s(4),y("ngModel",e.updatedProduct.code))},dependencies:[C,D,x,N,w,T,O,X],encapsulation:2})};var H=class l{constructor(n,t){this.fb=n;this.http=t;this.productForm=this.fb.group({id:Date.now(),name:"",code:"",price:0,quantity:0,discount:0,category:"",activity:""})}productForm;categories=[];activities=[];productAdded=new p;cancel=new p;save=new p;ngOnInit(){this.loadCategories(),this.loadActivities()}loadCategories(){this.http.get("http://localhost:8080/api/categories").subscribe(n=>{this.categories=n})}loadActivities(){this.http.get("http://localhost:8080/api/activities").subscribe(n=>{this.activities=n})}onCancel(){this.cancel.emit()}onSave(){if(this.productForm.valid){let n={id:"",name:this.productForm.value.name,code:Date.now(),price:this.productForm.value.price,quantity:this.productForm.value.quantity,discount:this.productForm.value.discount||0,category:{id:1},activity:{id:1}};console.log("Dati inviati al backend:",n),this.http.post("http://localhost:8080/api/products/addProduct",n).subscribe({next:()=>{alert("Prodotto aggiunto con successo!"),this.productAdded.emit()},error:t=>{console.error(t),alert("Errore nell'aggiunta del prodotto")}}),console.log("SOno qua")}}static \u0275fac=function(t){return new(t||l)(I(ne),I(K))};static \u0275cmp=f({type:l,selectors:[["app-add-product-dialog"]],outputs:{productAdded:"productAdded",cancel:"cancel",save:"save"},decls:25,vars:1,consts:[[1,"text-xl","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium"],["formControlName","name","name","name","type","text",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:ring-2","focus:ring-indigo-500"],["formControlName","category","name","category","type","text",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:ring-2","focus:ring-indigo-500"],["formControlName","quantity","name","quantity","type","number",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:ring-2","focus:ring-indigo-500"],["formControlName","price","name","price","type","number",1,"w-full","border","border-gray-300","rounded-md","p-2","focus:ring-2","focus:ring-indigo-500"],[1,"flex","justify-end","space-x-4","mt-6"],[1,"px-4","py-2","bg-gray-200","hover:bg-gray-300","rounded-md",3,"click"],[1,"px-4","py-2","bg-green-500","text-white","hover:bg-green-600","rounded-md",3,"click"]],template:function(t,e){t&1&&(o(0,"div")(1,"h2",0),d(2,"Aggiungi Prodotto"),i(),o(3,"form",1),c("ngSubmit",function(){return e.onSave()}),o(4,"div")(5,"label",2),d(6,"Nome:"),i(),M(7,"input",3),i(),o(8,"div")(9,"label",2),d(10,"Categoria:"),i(),M(11,"input",4),i(),o(12,"div")(13,"label",2),d(14,"Quantit\xE0:"),i(),M(15,"input",5),i(),o(16,"div")(17,"label",2),d(18,"Prezzo:"),i(),M(19,"input",6),i()(),o(20,"div",7)(21,"button",8),c("click",function(){return e.onCancel()}),d(22,"Annulla"),i(),o(23,"button",9),c("click",function(){return e.onSave()}),d(24,"Salva"),i()()()),t&2&&(s(3),m("formGroup",e.productForm))},dependencies:[C,D,x,N,w,T,ie,Y,Z],encapsulation:2})};var j=class l{applyAdvancedFilters(n,t){if(!t.trim())return n;let e=this.parseQuery(t);return Object.keys(e).length>0?n.filter(r=>this.itemMatchesFilters(r,e)):this.searchItems(n,t)}parseQuery(n){let t={},e=/(\w+):\s*([\w<>:]+|"[^"]*")/g,r;for(;(r=e.exec(n))!==null;){let a=r[1],E=r[2];E.startsWith('"')&&E.endsWith('"')&&(E=E.slice(1,-1)),t[a]=E}return t}itemMatchesFilters(n,t){for(let e in t){let r=t[e];switch(e){case"code":if(!n.code.includes(r))return!1;break;case"name":if(!n.name.toLowerCase().includes(r.toLowerCase()))return!1;break;case"price":if(!this.matchesNumberFilter(n.price,r))return!1;break;case"quantity":if(!this.matchesNumberFilter(n.quantity,r))return!1;break;default:break}}return!0}matchesNumberFilter(n,t){if(t.startsWith("<")){let e=parseFloat(t.slice(1));return n<e}else if(t.startsWith(">")){let e=parseFloat(t.slice(1));return n>e}else if(t.startsWith("=")){let e=parseFloat(t.slice(1));return n===e}else return n===parseFloat(t)}searchItems(n,t){return n.filter(e=>{let r=t.toLowerCase();return e.name.toLowerCase().includes(r)||e.code.toLowerCase().includes(r)})}static \u0275fac=function(t){return new(t||l)};static \u0275prov=L({token:l,factory:l.\u0275fac,providedIn:"root"})};function me(l,n){if(l&1){let t=P();o(0,"tr")(1,"td",15)(2,"input",6),c("change",function(){let r=g(t).$implicit,a=u();return _(a.toggleSelection(r.id))}),i()(),o(3,"td",7),d(4),i(),o(5,"td",7),d(6),i(),o(7,"td",7),d(8),i(),o(9,"td",7),d(10),i(),o(11,"td",7),d(12),R(13,"currency"),i(),o(14,"td",7),d(15),i(),o(16,"td",15)(17,"button",16),c("click",function(){let r=g(t).$implicit,a=u();return _(a.onEditItem(r.id))}),d(18," Modifica "),i()()()}if(l&2){let t=n.$implicit,e=u();B("bg-gray-50",e.selectedItems.has(t.id)),s(2),m("checked",e.selectedItems.has(t.id)),s(2),h(t.code),s(2),h(t.name),s(2),h(t.category),s(2),h(t.quantity),s(2),h(U(13,9,t.price,"EUR")),s(3),k("",t.discount,"%")}}function ue(l,n){if(l&1){let t=P();o(0,"app-edit-product-dialog",17),c("save",function(r){g(t);let a=u();return _(a.onSaveEdit(r))})("cancel",function(){g(t);let r=u();return _(r.onCancelEdit())}),i()}if(l&2){let t=u();m("product",t.editingItem)}}function pe(l,n){if(l&1){let t=P();o(0,"app-add-product-dialog",18),c("save",function(r){g(t);let a=u();return _(a.onSaveAdd(r))})("cancel",function(){g(t);let r=u();return _(r.onCancelAdd())})("productAdded",function(){g(t);let r=u();return _(r.loadItems())}),i()}}var ae=class l{constructor(n,t){this.filterService=n;this.productService=t}items=[];filteredItems=[];paginatedItems=[];selectedItems=new Set;selectedItemsCount=0;currentPage=1;itemsPerPage=10;totalPages=1;searchQuery="";editingItem=null;addingItem=!1;ngOnInit(){this.loadItems()}loadItems(){console.log("Sono in loaditems"),this.productService.getAllProducts().subscribe({next:n=>{this.items=n,console.log("items",this.items),this.filteredItems=[...this.items],this.selectedItemsCount=this.filteredItems.length,this.updatePagination()},error:n=>{console.error("Errore nel caricare gli item:",n)}})}updatePagination(){let n=(this.currentPage-1)*this.itemsPerPage,t=n+this.itemsPerPage;this.paginatedItems=this.filteredItems.slice(n,t),this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage)}onItemsPerPageChange(n){this.itemsPerPage=n,this.currentPage=1,this.updatePagination()}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updatePagination())}previousPage(){this.currentPage>1&&(this.currentPage--,this.updatePagination())}onSearch(n){this.searchQuery=n,this.filteredItems=this.filterService.applyAdvancedFilters(this.items,n),this.currentPage=1,this.updatePagination()}toggleSelectAll(){this.selectedItems.size===this.filteredItems.length?this.selectedItems.clear():this.filteredItems.forEach(n=>this.selectedItems.add(n.id))}toggleSelection(n){this.selectedItems.has(n)?this.selectedItems.delete(n):this.selectedItems.add(n)}deleteSelected(){this.items=this.items.filter(n=>!this.selectedItems.has(n.id)),this.filteredItems=[...this.items],this.selectedItems.clear(),this.updatePagination()}addItem(){this.addingItem=!0}onSaveAdd(n){this.items.push(n),this.filteredItems=[...this.items],this.addingItem=!1,this.updatePagination()}onCancelAdd(){this.addingItem=!1}onEditItem(n){this.editingItem=this.items.find(t=>t.id===n)||null}onSaveEdit(n){let t=this.items.findIndex(e=>e.id===n.id);t!==-1&&(this.items[t]=n,this.filteredItems=[...this.items]),this.editingItem=null,this.updatePagination()}onCancelEdit(){this.editingItem=null}get isAllSelected(){return this.selectedItems.size===this.filteredItems.length}static \u0275fac=function(t){return new(t||l)(I(j),I(oe))};static \u0275cmp=f({type:l,selectors:[["app-inventory"]],decls:33,vars:10,consts:[[1,"container","mx-auto","p-4"],[3,"search","selectAll","deleteSelected","itemsPerPageChange","addProduct","searchQuery","selectedCount"],[1,"overflow-x-auto","mt-4"],[1,"table-auto","w-full","border-collapse","border","border-gray-300"],[1,"bg-gray-100","text-left"],[1,"border","border-gray-300","p-2","w-10"],["type","checkbox",3,"change","checked"],[1,"border","border-gray-300","p-2"],[1,"border","border-gray-300","p-2","w-20"],[3,"bg-gray-50",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mt-4"],[1,"px-4","py-2","bg-gray-200","rounded-md","hover:bg-gray-300",3,"click","disabled"],[1,"text-sm","text-gray-600"],[3,"product","save","cancel",4,"ngIf"],[3,"save","cancel","productAdded",4,"ngIf"],[1,"border","border-gray-300","p-2","text-center"],[1,"text-blue-500","hover:text-blue-700",3,"click"],[3,"save","cancel","product"],[3,"save","cancel","productAdded"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"app-header-inventory",1),c("search",function(a){return e.onSearch(a)})("selectAll",function(){return e.toggleSelectAll()})("deleteSelected",function(){return e.deleteSelected()})("itemsPerPageChange",function(a){return e.onItemsPerPageChange(a)})("addProduct",function(){return e.addItem()}),i(),o(2,"div",2)(3,"table",3)(4,"thead")(5,"tr",4)(6,"th",5)(7,"input",6),c("change",function(){return e.toggleSelectAll()}),i()(),o(8,"th",7),d(9,"Codice"),i(),o(10,"th",7),d(11,"Nome"),i(),o(12,"th",7),d(13,"Categoria"),i(),o(14,"th",7),d(15,"Quantit\xE0"),i(),o(16,"th",7),d(17,"Prezzo"),i(),o(18,"th",7),d(19,"Sconto"),i(),o(20,"th",8),d(21,"Azione"),i()()(),o(22,"tbody"),S(23,me,19,12,"tr",9),i()()(),o(24,"div",10)(25,"button",11),c("click",function(){return e.previousPage()}),d(26," Precedente "),i(),o(27,"span",12),d(28),i(),o(29,"button",11),c("click",function(){return e.nextPage()}),d(30," Successiva "),i()(),S(31,ue,1,1,"app-edit-product-dialog",13)(32,pe,1,0,"app-add-product-dialog",14),i()),t&2&&(s(),m("searchQuery",e.searchQuery)("selectedCount",e.selectedItemsCount),s(6),m("checked",e.isAllSelected),s(16),m("ngForOf",e.paginatedItems),s(2),m("disabled",e.currentPage===1),s(3),G(" Pagina ",e.currentPage," di ",e.totalPages," "),s(),m("disabled",e.currentPage===e.totalPages),s(2),m("ngIf",e.editingItem),s(),m("ngIf",e.addingItem))},dependencies:[V,C,A,J,Q,H,F],styles:["@media screen and (max-width: 640px){.table-auto[_ngcontent-%COMP%]{display:block;overflow-x:auto}.table-auto[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.table-auto[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block}.table-auto[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;border-bottom:1px solid #ddd}.table-auto[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;width:100%;text-align:left;padding:12px}.table-auto[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(odd){background-color:#f9f9f9}.table-auto[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.table-auto[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{text-align:right}}"]})};export{ae as InventoryComponent};
